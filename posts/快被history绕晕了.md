# 快被 HTML5 history API 绕晕了

采用全 Ajax 加载之后很自然就会想到用 `history.pushState`，二者合一即为常说的 pjax。

今晚折腾了几个小时的 history api，改来改去，还是那几十行代码。为什么绕了那么久？

当我走出大山之后，回头才看清了自己绕了哪些弯路。究竟是要做成像 App 一样的跳转效果，还是在浏览器里网页的跳转效果？我在这个问题上摇摆不定，导致我的代码改过来又改回去。

**有什么区别呢？**

在 App 里面，最典型的页面跳转方式是**纵向**的，从起始页面开始，逐层深入，推出应用时，逐层往上返回，最终在起始页再点击返回则退出 App。

在浏览器里面，最典型的页面跳转是**线性**和**水平**的，比如你从内页点击链接跳转到了首页，再点击返回键，浏览器会回到内页，而不是退出这个网站，回到新建的标签页。

最终选择了 App 式的跳转方式。

之前完全是单页面的，即使可以在首页和文章之间跳转，但是跳转到首页必须通过点击 LOGO，如果按返回键则直接退出网站，回到新建的标签页了。现在解决了这个问题。

**还有一个改进**

文章有固定链接(就是WordPress里面的permalink)了，根据 URL 里面的 query 来加载文章。

之前不管是首页还是文章页，全都只有一个 URL，就是根域名。而在浏览器里直接输入根域名，则只会显示首页。本质上就是一个问题——文章没有固定链接，所以如果想跟别人分享文章，复制链接是完全没用的。

**总结**
虽然这几个小时写的代码很少，但是给整个系统带来的改变是实在的，我认为是有用的。并且，我很喜欢边开发，边记录的方式。而且是已经使用自己的产品（或者说软件）来做记录，这种感觉前所未有！爽！
